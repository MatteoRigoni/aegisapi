# ADR-006: Supply Chain â€” Cosign + SBOM

## Context
We must ensure artifact integrity, provenance, and vulnerability visibility for images and policy bundles.

## Decision
Sign container images and OPA bundles with **Sigstore Cosign** (keyless with OIDC). Generate **SBOM** using **Syft**; scan with **Trivy**; enforce via **Checkov/Policy** in CI. Store attestations in OCI registry. Enable **CodeQL** for code scanning.

## Alternatives
- Unsigned images; manual scanning (insufficient).
- Private GPG keys (harder key mgmt vs keyless OIDC).

## Consequences
- Slight CI/CD complexity increase; large security gain and auditability.

## Security Impact
- Only **signed & verified** images/bundles admitted (admission policy).
- Dependency risks tracked via SBOM; blocking on critical CVEs with exceptions process.

## Assumptions
- OCI registry supports attestations; admission controller policy in cluster.

## Trade-offs
- Occasional build breaks on new CVEs; mitigated with override+expiry workflow.

## Acceptance Criteria
- Release pipeline **fails** if: signature missing/invalid OR critical CVEs found without approved waiver.
- ImagePull policies verify Cosign before schedule (e.g., Ratify/Gatekeeper).
